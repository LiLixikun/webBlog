# 渲染过程
## 当我们输入网址后发生了什么

- 输入网址并回车
- 解析域名
- 浏览器发送HTTP请求
- 服务器处理请求
- 服务器返回HTML响应
- 浏览器处理HTML页面
- 继续请求其他资源

## 影响回流的操作




避免回流

读写分离

## 使用 fastdom

在 [fastdom事例](http://wilsonpage.github.io/fastdom/examples/animation.html) 中我们可以明确的感觉到用了 **fastdom** 页面流畅许多

现在我们自己来写个简单 demo 操作下:

我们点开 **performance**,查看页面绘制过程发现不停的 **Recalculate** 和进行 **layout** 

![layout](/optimization/fastdom.png)

但是我们使用 **fastdom** 进行读写分离后,发现进行了统一的操作,大大减少了浏览器的开销

![layout](/optimization/fastdom1.png)


## 减少重绘

利用 **DevTools** 识别 paint 的瓶颈,Chrome 工具的使用

![chrome](/optimization/chrome_performance_test.png)

**CSS 是否会引起重排和重绘**?

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .box {
            width:100px;
            height: 100px;
            border: 1px solid #ccc;
            border-radius: 50%;
            position: absolute;
            animation: cicleBox 2s infinite;
        }

        @keyframes cicleBox {
            0% {
                /* top: 0;
                left: 0; */
                transform:translate(0,0);
            }
            25% {
                /* top: 0;
                left: 200px; */
                transform:translate(200px,0);
            }
            50% {
                /* top: 200px;
                left: 200px; */
                transform:translate(200px,200px);
            }
            75% {
                /* top: 200px;
                left: 0; */
                transform:translate(0,200px);
            }
        }
    </style>
</head>
<body>
    <div class="box"></div>
</body>
</html>
```
::: tip 小结
使用 **top** **left** 会发现不断的重绘和重排

使用 **transform** 则没有

- Paint flashing 绿色代表重绘
- Layout 重排   
:::


利用 will-change 创建新的图层

图层不能过多,过多的会导致浏览器额外的开销。

## Optimize.js 优化初次加载时间

## 资源优化

html压缩

- 使用在线工具进行压缩
- 使用 npm 包进行压缩  html-minifier

css 压缩

- 在线工具压缩
- 使用 clean-css npm 包进行压缩

CSS JS资源合并


图片优化

图片优化的方案

SVG-Jpeg-WEBP

JPG/JPEG 压缩后像素不会丢失,不适合logo

imagemin 对jpg 图片进行压缩


PNG 优点3 可以使用透明
图标/logo

imagemin-pngquant 65%
能压缩80%的体积


webP优点

兼容性不好,压缩率和png 差不多

固定尺寸大小

懒加载

原生支持 加 loading 属性 就可以了 需要浏览器支持
第三方插件 lazyload

使用渐进式图片


使用响应式图片

- Srcset 属性的使用
- Sizes 属性的使用
- picuure的使用





## 字体优化

使用 font-display 

加载有限的字符集 需要时才去下载